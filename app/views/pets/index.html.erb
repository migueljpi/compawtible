<div class="header-top">
  <h1>All pets</h1>
</div>


<div class="row justify-content-center">
  <div class="col-sm-8 my-3">
    <%= form_with url: user_pets_path, method: :get, class: "d-flex" do %>
      <%= text_field_tag :query,
            params[:query],
            class: "form-control mx-3",
            placeholder: "Search for pets"
        %>
      <%= submit_tag "Search", name: "", class: "btn btn-primary" %>
    <% end %>
  </div>
</div>

<div class="row mt-5">
  <% @pets.each_with_index do |pet, index| %>
  <div class="col-lg-3 col-md-4  other-pets-card-container">
    <div class="pet-image-modal">
      <div class="animal-images">
          <% if pet.photos.attached? %>
          <div id="carouselExampleControls_<%= index %>" class="carousel slide">
            <div class="carousel-inner">
              <% pet.photos.each_with_index do |photo, idx| %>
                <div class="carousel-item <%= 'active' if idx == 0 %>">
                  <% if photo.present? %>
                    <%= cl_image_tag photo.key, class: "square-image" %>
                  <% else %>
                    <%= image_tag('dog.jpg', class: "square-image") %>
                  <% end %>
                </div>
              <% end %>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls_<%= index %>" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls_<%= index %>" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Next</span>
            </button>
          </div>
          <% else %>
            <!-- Placeholder carousel images -->
            <div id="carouselExampleControls_<%= index %>" class="carousel slide">
              <div class="carousel-inner">
                <div class="carousel-item active">
                  <%= image_tag("logo_paw_print.png", class: "square-image") %>
                </div>
              </div>
              <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls_<%= index %>" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
              </button>
              <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls_<%= index %>" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
              </button>
            </div>
          <% end %>
        <div class="animal-info">
          <div class="pet-name-modal-card">
            <div class="pet-name">
              <p><strong><%= pet.name %></strong></p>
            </div>
          </div>
          <div class="pet-description-modal-card">
            <p><%= pet.description %></p>
          </div>
            <div class="pet-card-modal-button d-flex justify-content-between">
              <%= link_to "View Pet", user_pet_path(pet.provider, pet), class: "btn btn-primary", data: { turbo: false } %>
              <%#= link_to 'Remove Pet', remove_pet_path(user_id: @user.id, id: pet.id), method: :delete, class: 'btn btn-danger', data: { confirm: 'Are you sure you want to remove this pet?' } %>
              <% if current_user.role == 'provider' %>
                  <%= link_to 'Remove Pet', remove_pet_path(user_id: @user.id, id: pet.id), method: :delete, class: 'btn btn-danger', data: { confirm: 'Are you sure you want to remove this pet?' } %>
              <% end %>
            </div>
        </div>
      </div>
    </div>
  </div>
  <% end %>
</div>
